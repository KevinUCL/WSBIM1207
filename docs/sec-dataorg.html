<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="Chapter 1 Data organisation with Spreadsheets | Introduction to bioinformatics" />
<meta property="og:type" content="book" />


<meta property="og:description" content="Course material for the Introduction to bioinformatics (WSBIM1207) course at UCLouvain." />


<meta name="author" content="Laurent Gatto" />

<meta name="date" content="2019-03-12" />


<meta name="description" content="Course material for the Introduction to bioinformatics (WSBIM1207) course at UCLouvain.">

<title>Chapter 1 Data organisation with Spreadsheets | Introduction to bioinformatics</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Introduction to bioinformatics<p><p class="author">Laurent Gatto</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preamble</a>
<a id="active-page" href="sec-dataorg.html"><span class="toc-section-number">1</span> Data organisation with Spreadsheets</a><ul class="toc-sections">
<li class="toc"><a href="#introduction"> Introduction</a></li>
<li class="toc"><a href="#problems-with-spreadsheets"> Problems with Spreadsheets</a></li>
<li class="toc"><a href="#formatting-data-tables-in-spreadsheets"> Formatting data tables in spreadsheets</a></li>
<li class="toc"><a href="#common-spreadsheet-errors"> Common Spreadsheet Errors</a></li>
<li class="toc"><a href="#dates"> Dates as data</a></li>
<li class="toc"><a href="#data-integrity"> Data integrity</a></li>
<li class="toc"><a href="#exporting-data"> Exporting data</a></li>
<li class="toc"><a href="#summary"> Summary</a></li>
<li class="toc"><a href="#additional-exercises"> Additional exercises</a></li>
</ul>
<a href="sec-startr.html"><span class="toc-section-number">2</span> Starting with R</a>
<a href="sec-startdata.html"><span class="toc-section-number">3</span> Starting with data</a>
<a href="sec-dplyr.html"><span class="toc-section-number">4</span> Manipulating and analyzing data with dplyr</a>
<a href="sec-vis.html"><span class="toc-section-number">5</span> Data visualization</a>
<a href="sec-join.html"><span class="toc-section-number">6</span> Joining tables</a>
<a href="sec-rr.html"><span class="toc-section-number">7</span> Reproducible research</a>
<a href="sec-bioinfo.html"><span class="toc-section-number">8</span> Bioinformatics</a>
<a href="sec-prog.html"><span class="toc-section-number">9</span> Additional programming concepts</a>
<a href="sec-ccl.html"><span class="toc-section-number">10</span> Conclusions</a>
<a href="session-information.html">Session information</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="sec:dataorg" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Data organisation with Spreadsheets</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>Questions:</p>
<ul>
<li>What are basic principles for using spreadsheets for good data organization?</li>
</ul>
<p>Objectives:</p>
<ul>
<li>Describe best practices for organizing data so computers can make the best use of data sets.</li>
</ul>
<p>Keypoints:</p>
<ul>
<li>Good data organization is the foundation of any research project.</li>
</ul>
<p>Good data organization is the foundation of your research project. Most researchers have data or do data entry in spreadsheets. Spreadsheet programs are very useful graphical interfaces for designing data tables and handling very basic data quality control functions. See also <span class="citation">Broman and Woo (<label for="tufte-mn-14" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-14" class="margin-toggle">2018<span class="marginnote">Broman, Karl W., and Kara H. Woo. 2018. “Data Organization in Spreadsheets.” <em>The American Statistician</em> 72 (1). Taylor &amp; Francis: 2–10. doi:<a href="https://doi.org/10.1080/00031305.2017.1375989">10.1080/00031305.2017.1375989</a>.</span>)</span>.</p>
<div id="spreadsheet-outline" class="section level3 unnumbered">
<h3>Spreadsheet outline</h3>
<p>After this lesson, you will be able to:</p>
<ul>
<li>Implement best practices in data table formatting</li>
<li>Identify and address common formatting mistakes</li>
<li>Understand approaches for handling dates in spreadsheets</li>
<li>Utilise basic quality control features and data manipulation practices</li>
<li>Effectively export data from spreadsheet programs</li>
</ul>
<p>Spreadsheets are good for data entry. Therefore we have a lot of data in spreadsheets. Much of your time as a researcher will be spent in this ‘data wrangling’ stage. It’s not the most fun, but it’s necessary. We’ll teach you how to think about data organization and some practices for more effective data wrangling.</p>
</div>
<div id="what-this-lesson-will-not-teach-you" class="section level3 unnumbered">
<h3>What this lesson will not teach you</h3>
<ul>
<li>How to do <em>statistics</em> in a spreadsheet</li>
<li>How to do <em>plotting</em> in a spreadsheet</li>
<li>How to <em>write code</em> in spreadsheet programs</li>
</ul>
<p>If you’re looking to do this, a good reference is <a href="https://www.amazon.com/Head-First-Excel-learners-spreadsheets/dp/0596807694/">Head First Excel</a>, published by O’Reilly</p>
</div>
<div id="why-arent-we-teaching-data-analysis-in-spreadsheets" class="section level3 unnumbered">
<h3>Why aren’t we teaching data analysis in spreadsheets</h3>
<ul>
<li><p>Data analysis in spreadsheets usually requires a lot of manual work. If you want to change a parameter or run an analysis with a new dataset, you usually have to redo everything by hand. (We do know that you can create macros, but see the next point.)</p></li>
<li><p>It is also difficult to track or reproduce statistical or plotting analyses done in spreadsheet programs when you want to go back to your work or someone asks for details of your analysis.</p></li>
</ul>
</div>
<div id="spreadsheet-programs" class="section level3 unnumbered">
<h3>Spreadsheet programs</h3>
<p>Many spreadsheet programs are available. Since most participants utilise Excel as their primary spreadsheet program, this lesson will make use of Excel examples. A free spreadsheet program that can also be used is LibreOffice. Commands may differ a bit between programs, but the general idea is the same.</p>
<p>Spreadsheets encompass a lot of the things we need to be able to do as researchers. We can use them for:</p>
<ul>
<li>Data entry</li>
<li>Organizing data</li>
<li>Subsetting and sorting data</li>
<li>Statistics</li>
<li>Plotting</li>
</ul>
<p>Here are three examples from research papers:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-1"></span>
<p class="caption marginnote shownote">
Figure 1.1: A figure from a bioinformatics paper (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3866554/">Hugues et al. (2014)</a>) that compares different proteomics data processing methods (along the columns) and how (1) these methods control false positive rate for spiked-in data, (2) their effect on the variabilty due to different operators, and (2) how they affect the root mean square error (RMSE).
</p>
<img src="figs/tab1.png" alt="A figure from a bioinformatics paper ([Hugues et al. (2014)](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3866554/)) that compares different proteomics data processing methods (along the columns) and how (1) these methods control false positive rate for spiked-in data, (2) their effect on the variabilty due to different operators, and (2) how they affect the root mean square error (RMSE)." width="100%"  />
</div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<p class="caption marginnote shownote">
Figure 1.2: This table summarises the spatial proteomics experiments that were re-analysed as part a meta-analysis by <a href="https://www.sciencedirect.com/science/article/pii/S1367593118301339">Gatto et al. (2018)</a>.
</p>
<img src="figs/tab2.png" alt="This table summarises the spatial proteomics experiments that were re-analysed as part a meta-analysis by [Gatto et al. (2018)](https://www.sciencedirect.com/science/article/pii/S1367593118301339). " width="100%"  />
</div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<p class="caption marginnote shownote">
Figure 1.3: Parts of the quantitative data of a spatial proteomics dataset by <a href="https://www.nature.com/articles/s41467-018-08191-w">Geladaki et al. (2019)</a>. The supplementary table is available <a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41467-018-08191-w/MediaObjects/41467_2018_8191_MOESM4_ESM.xlsx">here</a>
</p>
<img src="figs/tab3a.png" alt="Parts of the quantitative data of a spatial proteomics dataset by [Geladaki et al. (2019)](https://www.nature.com/articles/s41467-018-08191-w). The supplementary table is available [here](https://static-content.springer.com/esm/art%3A10.1038%2Fs41467-018-08191-w/MediaObjects/41467_2018_8191_MOESM4_ESM.xlsx)" width="100%"  />
</div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<p class="caption marginnote shownote">
Figure 1.4: Luminescence read-out of a 96 well plate. The file is available <a href="https://github.com/UCLouvain-CBIO/WSBIM1207/files/2836821/luminescence.xlsx">here</a>.
</p>
<img src="figs/tab4.png" alt="Luminescence read-out of a 96 well plate. The file is available [here](https://github.com/UCLouvain-CBIO/WSBIM1207/files/2836821/luminescence.xlsx)." width="100%"  />
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Discuss the following points with your neighbour</p>
<ul>
<li>How many people have used spreadsheets, in their research, courses, or at home?</li>
<li>What kind of operations do you do in spreadsheets?</li>
<li>Which ones do you think spreadsheets are good for?</li>
<li>How many people have accidentally done something that made them frustrated or sad?</li>
</ul>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
</div>
<div id="problems-with-spreadsheets" class="section level2">
<h2><span class="header-section-number">1.2</span> Problems with Spreadsheets</h2>
<p>Spreadsheets are good for data entry, but in reality we tend to use spreadsheet programs for much more than data entry. We use them to create data tables for publications, to generate summary statistics, and make figures.</p>
<p>Generating tables for publications in a spreadsheet is not optimal - often, when formatting a data table for publication, we’re reporting key summary statistics in a way that is not really meant to be read as data, and often involves special formatting (merging cells, creating borders, making it pretty). We advise you to do this sort of operation within your document editing software.</p>
<p>The latter two applications, generating statistics and figures, should be used with caution: because of the graphical, drag and drop nature of spreadsheet programs, it can be very difficult, if not impossible, to replicate your steps (much less retrace anyone else’s), particularly if your stats or figures require you to do more complex calculations. Furthermore, in doing calculations in a spreadsheet, it’s easy to accidentally apply a slightly different formula to multiple adjacent cells. When using a command-line based statistics program like R or SAS, it’s practically impossible to apply a calculation to one observation in your dataset but not another unless you’re doing it on purpose.</p>
<div id="using-spreadsheets-for-data-entry-and-cleaning" class="section level3 unnumbered">
<h3>Using Spreadsheets for Data Entry and Cleaning</h3>
<p>However, there are circumstances where you might want to use a spreadsheet program to produce “quick and dirty” calculations or figures, and data cleaning will help you use some of these features. Data cleaning also puts your data in a better format prior to importation into a statistical analysis program. We will show you how to use some features of spreadsheet programs to check your data quality along the way and produce preliminary summary statistics.</p>
<p>In this lesson, we will assume that you are most likely using Excel as your primary spreadsheet program - there are others (gnumeric, Calc from OpenOffice), and their functionality is similar, but Excel seems to be the program most used by biologists and biomedical researchers.</p>
<p>In this lesson we’re going to talk about:</p>
<ol style="list-style-type: decimal">
<li>Formatting data tables in spreadsheets</li>
<li>Formatting problems</li>
<li>Dates as data</li>
<li>Quality control</li>
<li>Exporting data</li>
</ol>
</div>
</div>
<div id="formatting-data-tables-in-spreadsheets" class="section level2">
<h2><span class="header-section-number">1.3</span> Formatting data tables in spreadsheets</h2>
<p><strong>Questions</strong></p>
<ul>
<li>How do we format data in spreadsheets for effective data use?</li>
</ul>
<p><strong>Objectives</strong></p>
<ul>
<li><p>Describe best practices for data entry and formatting in spreadsheets.</p></li>
<li><p>Apply best practices to arrange variables and observations in a spreadsheet.</p></li>
</ul>
<p><strong>Keypoints</strong></p>
<ul>
<li><p>Never modify your raw data. Always make a copy before making any changes.</p></li>
<li><p>Keep track of all of the steps you take to clean your data in a plain text file.</p></li>
<li><p>Organize your data according to tidy data principles.</p></li>
</ul>
<p>The most common mistake made is treating spreadsheet programs like lab notebooks, that is, relying on context, notes in the margin, spatial layout of data and fields to convey information. As humans, we can (usually) interpret these things, but computers don’t view information the same way, and unless we explain to the computer what every single thing means (and that can be hard!), it will not be able to see how our data fits together.</p>
<p>Using the power of computers, we can manage and analyze data in much more effective and faster ways, but to use that power, we have to set up our data for the computer to be able to understand it (and computers are very literal).</p>
<p>This is why it’s extremely important to set up well-formatted tables from the outset - before you even start entering data from your very first preliminary experiment. Data organization is the foundation of your research project. It can make it easier or harder to work with your data throughout your analysis, so it’s worth thinking about when you’re doing your data entry or setting up your experiment. You can set things up in different ways in spreadsheets, but some of these choices can limit your ability to work with the data in other programs or have the you-of-6-months-from-now or your collaborator work with the data.</p>
<blockquote>
<p><strong>Note:</strong> the best layouts/formats (as well as software and interfaces) for data entry and data analysis might be different. It is important to take this into account, and ideally automate the conversion from one to another.</p>
</blockquote>
<div id="keeping-track-of-your-analyses" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Keeping track of your analyses</h3>
<p>When you’re working with spreadsheets, during data clean up or analyses, it’s very easy to end up with a spreadsheet that looks very different from the one you started with. In order to be able to reproduce your analyses or figure out what you did when a reviewer or instructor asks for a different analysis, you should</p>
<ul>
<li><p>create a new file with your cleaned or analyzed data. Don’t modify the original dataset, or you will never know where you started!</p></li>
<li><p>keep track of the steps you took in your clean up or analysis. You should track these steps as you would any step in an experiment. We recommend that you do this in a plain text file stored in the same folder as the data file.</p></li>
</ul>
<p>This might be an example of a spreadsheet setup:</p>
<div class="figure">
<img src="figs/spreadsheet-setup-updated.png" />

</div>
<p>Put these principles in to practice today during your Exercises.</p>
<blockquote>
<p><strong>Note:</strong> This is out of scope for this lesson, but for information on how to maintain version control over your data, look at our lesson on <a href="http://swcarpentry.github.io/git-novice/">‘Git’</a>. See also this <a href="https://lgatto.github.io/github-intro/">blog post</a> for a quick tutorial or <span class="citation">Perez-Riverol (<label for="tufte-mn-15" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-15" class="margin-toggle">2016<span class="marginnote">Perez-Riverol, Laurent AND Wang, Yasset AND Gatto. 2016. “Ten Simple Rules for Taking Advantage of Git and GitHub.” <em>PLOS Computational Biology</em> 12 (7). Public Library of Science: 1–11. doi:<a href="https://doi.org/10.1371/journal.pcbi.1004947">10.1371/journal.pcbi.1004947</a>.</span>)</span> for a more research-oriented use-case.</p>
</blockquote>
</div>
<div id="structuring-data-in-spreadsheets" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Structuring data in spreadsheets</h3>
<p>The cardinal rules of using spreadsheet programs for data:</p>
<ol style="list-style-type: decimal">
<li>Put all your variables in columns - the thing you’re measuring, like ‘weight’ or ‘temperature’.</li>
<li>Put each observation in its own row.</li>
<li>Don’t combine multiple pieces of information in one cell. Sometimes it just seems like one thing, but think if that’s the only way you’ll want to be able to use or sort that data.</li>
<li>Leave the raw data raw - don’t change it!</li>
<li>Export the cleaned data to a text-based format like CSV (comma-separated values) format. This ensures that anyone can use the data, and is required by most data repositories.</li>
</ol>
<p>For instance, we have data from a survey of small mammals in a desert ecosystem. Different people have gone to the field and entered data into a spreadsheet. They keep track of things like species, plot, weight, sex and date collected.</p>
<p>If they were to keep track of the data like this:</p>
<div class="figure">
<img src="figs/multiple-info.png" />

</div>
<p>the problem is that species and sex are in the same field. So, if they wanted to look at all of one species or look at different weight distributions by sex, it would be hard to do this using this data setup. If instead we put sex and species in different columns, you can see that it would be much easier.</p>
<p>The rule of thumb, when setting up a datasheet, is</p>
<blockquote>
<p><strong>Columns for variables and rows for observations</strong></p>
</blockquote>
<ul>
<li>columns = variables</li>
<li>rows = observations</li>
<li>cells = data (values)</li>
</ul>
<p>So, instead we should have:</p>
<div class="figure">
<img src="figs/single-info.png" />

</div>
<p><strong>Discussion</strong></p>
<p>The data used in the lessons are observations of a small mammal community in southern Arizona. This is part of a project studying the effects of rodents and ants on the plant community that has been running for almost 40 years. The rodents are sampled on a series of 24 plots, with different experimental manipulations controlling which rodents are allowed to access which plots.</p>
<p>This is a real dataset that has been used in over 100 publications. We’ve simplified it just a little bit for the workshop, but you can download the full dataset and work with it using exactly the same tools we’ll learn about today.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>We’re going to take a messy version of the survey data and describe how we would clean it up.</p>
<ol style="list-style-type: decimal">
<li><p>Download the data by clicking <a href="https://ndownloader.figshare.com/files/2252083">here</a> to get it from FigShare.</p></li>
<li><p>Open up the data in a spreadsheet program.</p></li>
<li><p>You can see that there are two tabs. Two field assistants conducted the surveys, one in 2013 and one in 2014, and they both kept track of the data in their own way. Now you’re the person in charge of this project and you want to be able to start analyzing the data.</p></li>
<li><p>With the person next to you, identify what is wrong with this spreadsheet. Also discuss the steps you would need to take to clean up the 2013 and 2014 tabs, and to put them all together in one spreadsheet.</p></li>
</ol>
<p><strong>Important</strong> Do not forget our first piece of advice: to create a new file (or tab) for the cleaned data, never modify your original (raw) data.</p>
<p>After you go through this exercise, we’ll discuss as a group what was wrong with this data and how you would fix it.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<!-- - Take about 10 minutes to work on this exercise. -->
<!-- - All the mistakes in the *common mistakes* section below are present -->
<!--   in the messy dataset. If the exercise is done during a workshop, ask -->
<!--   people what they saw as wrong with the data. As they bring up -->
<!--   different points, you can refer to the common mistakes or expand a -->
<!--   bit on the point they brought up. -->
<!-- - If you get a response where they've fixed the date, you can pause -->
<!--   and go to the dates lesson. Or you can say you'll come back to dates -->
<!--   at the end. -->
<p>An <strong>excellent reference</strong>, in particular with regard to R scripting is the <em>Tidy Data</em> paper <span class="citation">Wickham (<label for="tufte-mn-16" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-16" class="margin-toggle">2014<span class="marginnote">Wickham, Hadley. 2014. “Tidy Data.” <em>Journal of Statistical Software, Articles</em> 59 (10): 1–23. doi:<a href="https://doi.org/10.18637/jss.v059.i10">10.18637/jss.v059.i10</a>.</span>)</span>.</p>
</div>
</div>
<div id="common-spreadsheet-errors" class="section level2">
<h2><span class="header-section-number">1.4</span> Common Spreadsheet Errors</h2>
<p>Questions:</p>
<ul>
<li>What are some common challenges with formatting data in spreadsheets and how can we avoid them?</li>
</ul>
<p>Objectives:</p>
<ul>
<li>Recognize and resolve common spreadsheet formatting problems.</li>
</ul>
<p>Keypoints:</p>
<ul>
<li>Avoid using multiple tables within one spreadsheet.</li>
<li>Avoid spreading data across multiple tabs.</li>
<li>Record zeros as zeros.</li>
<li>Use an appropriate null value to record missing data.</li>
<li>Don’t use formatting to convey information or to make your spreadsheet look pretty.</li>
<li>Place comments in a separate column.</li>
<li>Record units in column headers.</li>
<li>Include only one piece of information in a cell.</li>
<li>Avoid spaces, numbers and special characters in column headers.</li>
<li>Avoid special characters in your data.</li>
<li>Record metadata in a separate plain text file.</li>
</ul>
<!-- This lesson is meant to be used as a reference for discussion as -->
<!-- learners identify issues with the messy dataset discussed in the -->
<!-- previous lesson. Instructors: don't go through this lesson except to -->
<!-- refer to responses to the exercise in the previous lesson. -->
<p>There are a few potential errors to be on the lookout for in your own data as well as data from collaborators or the Internet. If you are aware of the errors and the possible negative effect on downstream data analysis and result interpretation, it might motivate yourself and your project members to try and avoid them. Making small changes to the way you format your data in spreadsheets, can have a great impact on efficiency and reliability when it comes to data cleaning and analysis.</p>
<ul>
<li><a href="sec-dataorg.html#tables">Using multiple tables</a></li>
<li><a href="sec-dataorg.html#tabs">Using multiple tabs</a></li>
<li><a href="sec-dataorg.html#zeros">Not filling in zeros</a></li>
<li><a href="sec-dataorg.html#null">Using problematic null values</a></li>
<li><a href="sec-dataorg.html#formatting">Using formatting to convey information</a></li>
<li><a href="sec-dataorg.html#formatting_pretty">Using formatting to make the data sheet look pretty</a></li>
<li><a href="sec-dataorg.html#units">Placing comments or units in cells</a></li>
<li><a href="sec-dataorg.html#info">Entering more than one piece of information in a cell</a></li>
<li><a href="sec-dataorg.html#field_name">Using problematic field names</a></li>
<li><a href="sec-dataorg.html#special">Using special characters in data</a></li>
<li><a href="sec-dataorg.html#metadata">Inclusion of metadata in data table</a></li>
<li><a href="sec-dataorg.html#dates">Date formatting</a></li>
</ul>
<div id="tables" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Using multiple tables</h3>
<p>A common strategy is creating multiple data tables within one spreadsheet. This confuses the computer, so don’t do this! When you create multiple tables within one spreadsheet, you’re drawing false associations between things for the computer, which sees each row as an observation. You’re also potentially using the same field name in multiple places, which will make it harder to clean your data up into a usable form. The example below depicts the problem:</p>
<div class="figure">
<img src="figs/2_datasheet_example.jpg" />

</div>
<p>In the example above, the computer will see (for example) row 4 and assume that all columns A-AF refer to the same sample. This row actually represents four distinct samples (sample 1 for each of four different collection dates - May 29th, June 12th, June 19th, and June 26th), as well as some calculated summary statistics (an average (avr) and standard error of measurement (SEM)) for two of those samples. Other rows are similarly problematic.</p>
</div>
<div id="tabs" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Using multiple tabs</h3>
<p>But what about workbook tabs? That seems like an easy way to organize data, right? Well, yes and no. When you create extra tabs, you fail to allow the computer to see connections in the data that are there (you have to introduce spreadsheet application-specific functions or scripting to ensure this connection). Say, for instance, you make a separate tab for each day you take a measurement.</p>
<p>This isn’t good practice for two reasons:</p>
<ol style="list-style-type: decimal">
<li><p>you are more likely to accidentally add inconsistencies to your data if each time you take a measurement, you start recording data in a new tab, and</p></li>
<li><p>even if you manage to prevent all inconsistencies from creeping in, you will add an extra step for yourself before you analyze the data because you will have to combine these data into a single datatable. You will have to explicitly tell the computer how to combine tabs - and if the tabs are inconsistently formatted, you might even have to do it manually.</p></li>
</ol>
<p>The next time you’re entering data, and you go to create another tab or table, ask yourself if you could avoid adding this tab by adding another column to your original spreadsheet. We used multiple tabs in our example of a messy data file, but now you’ve seen how you can reorganize your data to consolidate across tabs.</p>
<p>Your data sheet might get very long over the course of the experiment. This makes it harder to enter data if you can’t see your headers at the top of the spreadsheet. But don’t repeat your header row. These can easily get mixed into the data, leading to problems down the road.</p>
<p>Instead you can freeze the column headers so that they remain visible even when you have a spreadsheet with many rows.</p>
<p><a href="https://support.office.com/en-ca/article/Freeze-column-headings-for-easy-scrolling-57ccce0c-cf85-4725-9579-c5d13106ca6a">Documentation on how to freeze column headers</a></p>
</div>
<div id="zeros" class="section level3">
<h3><span class="header-section-number">1.4.3</span> Not filling in zeros</h3>
<p>It might be that when you’re measuring something, it’s usually a zero, say the number of times a rabbit is observed in the survey. Why bother writing in the number zero in that column, when it’s mostly zeros?</p>
<p>However, there’s a difference between a zero and a blank cell in a spreadsheet. To the computer, a zero is actually data. You measured or counted it. A blank cell means that it wasn’t measured and the computer will interpret it as an unknown value (otherwise known as a null value).</p>
<p>The spreadsheets or statistical programs will likely mis-interpret blank cells that you intend to be zeros. By not entering the value of your observation, you are telling your computer to represent that data as unknown or missing (null). This can cause problems with subsequent calculations or analyses. For example, the average of a set of numbers which includes a single null value is always null (because the computer can’t guess the value of the missing observations). Because of this, it’s very important to record zeros as zeros and truly missing data as nulls.</p>
</div>
<div id="null" class="section level3">
<h3><span class="header-section-number">1.4.4</span> Using problematic null values</h3>
<p><strong>Example</strong>: using -999 or other numerical values (or zero) to represent missing data.</p>
<p><strong>Solutions</strong>:</p>
<p>There are a few reasons why null values get represented differently within a dataset. Sometimes confusing null values are automatically recorded from the measuring device. If that’s the case, there’s not much you can do, but it can be addressed in data cleaning with a tool like <a href="http://www.datacarpentry.org/OpenRefine-ecology-lesson/">OpenRefine</a> before analysis. Other times different null values are used to convey different reasons why the data isn’t there. This is important information to capture, but is in effect using one column to capture two pieces of information. Like for <a href="sec-dataorg.html#formatting">using formatting to convey information</a>((#formatting) it would be good here to create a new column like ‘data_missing’ and use that column to capture the different reasons.</p>
<p>Whatever the reason, it’s a problem if unknown or missing data is recorded as -999, 999, or 0.</p>
<p>Many statistical programs will not recognize that these are intended to represent missing (null) values. How these values are interpreted will depend on the software you use to analyze your data. It is essential to use a clearly defined and consistent null indicator.</p>
<p>Blanks (most applications) and NA (for R) are good choices. <span class="citation">White et al. (<label for="tufte-mn-17" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-17" class="margin-toggle">2013<span class="marginnote">White, Ethan P., Elita Baldridge, Zachary T. Brym, Kenneth J. Locey, Daniel J. McGlinn, and Sarah R. Supp. 2013. “Nine Simple Ways to Make It Easier to (Re)use Your Data.” <em>PeerJ PrePrints</em> 1 (July): e7v2. doi:<a href="https://doi.org/10.7287/peerj.preprints.7v2">10.7287/peerj.preprints.7v2</a>.</span>)</span> explain good choices for indicating null values for different software applications in their article:</p>
<div class="figure">
<img src="figs/3_white_table_1.jpg" />

</div>
</div>
<div id="formatting" class="section level3">
<h3><span class="header-section-number">1.4.5</span> Using formatting to convey information</h3>
<p><strong>Example</strong>: highlighting cells, rows or columns that should be excluded from an analysis, leaving blank rows to indicate separations in data.</p>
<div class="figure">
<img src="figs/formatting.png" />

</div>
<p><strong>Solution</strong>: create a new field to encode which data should be excluded.</p>
<div class="figure">
<img src="figs/good_formatting.png" />

</div>
</div>
<div id="formatting_pretty" class="section level3">
<h3><span class="header-section-number">1.4.6</span> Using formatting to make the data sheet look pretty</h3>
<p><strong>Example</strong>: merging cells.</p>
<p><strong>Solution</strong>: If you’re not careful, formatting a worksheet to be more aesthetically pleasing can compromise your computer’s ability to see associations in the data. Merged cells will make your data unreadable by statistics software. Consider restructuring your data in such a way that you will not need to merge cells to organize your data.</p>
</div>
<div id="units" class="section level3">
<h3><span class="header-section-number">1.4.7</span> Placing comments or units in cells</h3>
<p><strong>Example</strong>: Your data was collected, in part, by a summer student who you later found out was mis-identifying some of your species, some of the time. You want a way to note these data are suspect.</p>
<p><strong>Solution</strong>: Most analysis software can’t see Excel or LibreOffice comments, and would be confused by comments placed within your data cells. As described above for formatting, create another field if you need to add notes to cells. Similarly, don’t include units in cells: ideally, all the measurements you place in one column should be in the same unit, but if for some reason they aren’t, create another field and specify the units the cell is in.</p>
</div>
<div id="info" class="section level3">
<h3><span class="header-section-number">1.4.8</span> Entering more than one piece of information in a cell</h3>
<p><strong>Example</strong>: You find one male, and one female of the same species. You enter this as <code>1M</code>, <code>1F</code>.</p>
<p><strong>Solution</strong>: Don’t include more than one piece of information in a cell. This will limit the ways in which you can analyze your data. If you need both these measurements, design your data sheet to include this information. For example, include one column for number of individuals and a separate column for sex.</p>
</div>
<div id="field_name" class="section level3">
<h3><span class="header-section-number">1.4.9</span> Using problematic field names</h3>
<p>Choose descriptive field names, but be careful not to include spaces, numbers, or special characters of any kind. Spaces can be misinterpreted by parsers that use whitespace as delimiters and some programs don’t like field names that are text strings that start with numbers.</p>
<p>Underscores (<code>_</code>) are a good alternative to spaces. Consider writing names in camel case (like this: ExampleFileName) to improve readability. Remember that abbreviations that make sense at the moment may not be so obvious in 6 months, but don’t overdo it with names that are excessively long. Including the units in the field names avoids confusion and enables others to readily interpret your fields.</p>
<p><strong>Examples</strong></p>
<table>
<thead>
<tr class="header">
<th>Good Name</th>
<th>Good Alternative</th>
<th>Avoid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Max_temp_C</td>
<td>MaxTemp</td>
<td>Maximum Temp (°C)</td>
</tr>
<tr class="even">
<td>Precipitation_mm</td>
<td>Precipitation</td>
<td>precmm</td>
</tr>
<tr class="odd">
<td>Mean_year_growth</td>
<td>MeanYearGrowth</td>
<td>Mean growth/year</td>
</tr>
<tr class="even">
<td>sex</td>
<td>sex</td>
<td>M/F</td>
</tr>
<tr class="odd">
<td>weight</td>
<td>weight</td>
<td>w.</td>
</tr>
<tr class="even">
<td>cell_type</td>
<td>CellType</td>
<td>Cell Type</td>
</tr>
<tr class="odd">
<td>Observation_01</td>
<td>first_observation</td>
<td>1st Obs</td>
</tr>
</tbody>
</table>
</div>
<div id="special" class="section level3">
<h3><span class="header-section-number">1.4.10</span> Using special characters in data</h3>
<p><strong>Example</strong>: You treat your spreadsheet program as a word processor when writing notes, for example copying data directly from Word or other applications.</p>
<p><strong>Solution</strong>: This is a common strategy. For example, when writing longer text in a cell, people often include line breaks, em-dashes, etc in their spreadsheet. Also, when copying data in from applications such as Word, formatting and fancy non-standard characters (such as left- and right-aligned quotation marks) are included. When exporting this data into a coding/statistical environment or into a relational database, dangerous things may occur, such as lines being cut in half and encoding errors being thrown.</p>
<p>General best practice is to avoid adding characters such as newlines, tabs, and vertical tabs. In other words, treat a text cell as if it were a simple web form that can only contain text and spaces.</p>
</div>
<div id="metadata" class="section level3">
<h3><span class="header-section-number">1.4.11</span> Inclusion of metadata in data table</h3>
<p><strong>Example</strong>: You add a legend at the top or bottom of your data table explaining column meaning, units, exceptions, etc.</p>
<p><strong>Solution</strong>: Recording data about your data (“metadata”) is essential. You may be on intimate terms with your dataset while you are collecting and analysing it, but the chances that you will still remember that the variable “sglmemgp” means single member of group, for example, or the exact algorithm you used to transform a variable or create a derived one, after a few months, a year, or more are slim.</p>
<p>As well, there are many reasons other people may want to examine or use your data - to understand your findings, to verify your findings, to review your submitted publication, to replicate your results, to design a similar study, or even to archive your data for access and re-use by others. While digital data by definition are machine-readable, understanding their meaning is a job for human beings. The importance of documenting your data during the collection and analysis phase of your research cannot be overestimated, especially if your research is going to be part of the scholarly record.</p>
<p>However, metadata should not be contained in the data file itself. Unlike a table in a paper or a supplemental file, metadata (in the form of legends) should not be included in a data file since this information is not data, and including it can disrupt how computer programs interpret your data file. Rather, metadata should be stored as a separate file in the same directory as your data file, preferably in plain text format with a name that clearly associates it with your data file. Because metadata files are free text format, they also allow you to encode comments, units, information about how null values are encoded, etc. that are important to document but can disrupt the formatting of your data file.</p>
<p>Additionally, file or database level metadata describes how files that make up the dataset relate to each other; what format are they in; and whether they supercede or are superceded by previous files. A folder-level readme.txt file is the classic way of accounting for all the files and folders in a project.</p>
<p>(Text on metadata adapted from the online course Research Data <a href="http://datalib.edina.ac.uk/mantra">MANTRA</a> by EDINA and Data Library, University of Edinburgh. MANTRA is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.)</p>
</div>
</div>
<div id="dates" class="section level2">
<h2><span class="header-section-number">1.5</span> Dates as data</h2>
<p>Questions:</p>
<ul>
<li>What are good approaches for handling dates in spreadsheets?</li>
</ul>
<p>Objectives:</p>
<ul>
<li>Describe how dates are stored and formatted in spreadsheets.</li>
<li>Describe the advantages of alternative date formatting in spreadsheets.</li>
<li>Demonstrate best practices for entering dates in spreadsheets.</li>
</ul>
<p>Keypoints:</p>
<ul>
<li>Treating dates as multiple pieces of data rather than one makes them easier to handle.</li>
</ul>
<p>Dates in spreadsheets are stored in a single column. While this seems the most natural way to record dates, it actually is not best practice. A spreadsheet application will display the dates in a seemingly correct way (to a human observer) but how it actually handles and stores the dates may be problematic.</p>
<p>In particular, please remember that functions that are valid for a given spreadsheet program (be it LibreOffice, Microsoft Excel, OpenOffice, Gnumeric, etc.) are usually guaranteed to be compatible only within the same family of products. If you will later need to export the data and need to conserve the timestamps, you are better off handling them using one of the solutions discussed below.</p>
<p>Additionally, Excel can <a href="https://nsaunders.wordpress.com/2012/10/22/gene-name-errors-and-excel-lessons-not-learned/">turn things that aren’t dates into dates</a> (<span class="citation">Zeeberg et al. (<label for="tufte-mn-18" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-18" class="margin-toggle">2004<span class="marginnote">Zeeberg, Barry R., Joseph Riss, David W. Kane, Kimberly J. Bussey, Edward Uchio, W. Marston Linehan, J. Carl Barrett, and John N. Weinstein. 2004. “Mistaken Identifiers: Gene Name Errors Can Be Introduced Inadvertently When Using Excel in Bioinformatics.” <em>BMC Bioinformatics</em> 5 (1): 80. doi:<a href="https://doi.org/10.1186/1471-2105-5-80">10.1186/1471-2105-5-80</a>.</span>)</span>), for example names or identifiers like MAR1, DEC1, OCT4. So if you’re avoiding the date format overall, it’s easier to identify these issues.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Challenge: pulling month, day and year out of dates</p>
<ul>
<li><p>In the <code>dates</code> tab of your spreadsheet you have the data from 2014 plot 3. There’s a <code>Date collected</code> column.</p></li>
<li><p>Let’s extract month, day and year from the dates to new columns. For this we can use the built in Excel functions</p></li>
</ul>
<pre><code>YEAR()
MONTH()
DAY()</code></pre>
<p>Make sure the new column is formatted as a number and not as a date.</p>
<!-- You can see that even though you wanted the year to be 2014, your -->
<!-- spreadsheet program automatically interpreted it as 2015, the year you -->
<!-- entered the data. -->
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-1" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-1&#39;, &#39;sol-start-1&#39;)"></span>
</p>
<div id="sol-body-1" class="solution-body" style="display: none;">
<div class="figure">
<img src="figs/solution_exercise_1_dates.png" />

</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Challenge: pulling hour, minute and second out of the current time</p>
<p>Current time and date are best retrieved using the functions <code>NOW()</code>, which returns the current date and time, and <code>TODAY()</code>, which returns the current date. The results will be formatted according to your computer’s settings.</p>
<ol style="list-style-type: decimal">
<li><p>Extract the year, month and day from the current date and time string returned by the <code>NOW()</code> function.</p></li>
<li><p>Calculate the current time using <code>NOW()-TODAY()</code>.</p></li>
<li><p>Extract the hour, minute and second from the current time using functions <code>HOUR()</code>, <code>MINUTE()</code> and <code>SECOND()</code>.</p></li>
</ol>
<ol start="4" style="list-style-type: decimal">
<li>Press <code>F9</code> to force the spreadsheet to recalculate the <code>NOW()</code> function, and check that it has been updated.</li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-2" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-2&#39;, &#39;sol-start-2&#39;)"></span>
</p>
<div id="sol-body-2" class="solution-body" style="display: none;">
<ol style="list-style-type: decimal">
<li><p>To get the year, type <code>=YEAR(NOW())</code> into any cell in your spreadsheet. To get the month, type <code>=MONTH(NOW())</code>. To get the day, type <code>=DAY(NOW())</code>.</p></li>
<li><p>Typing <code>=NOW()-TODAY()</code> will result in a decimal value that is not easily human parsable to a clock-based time. You will need to use the strategies in the third part of this challenge to convert this decimal value to readable time.</p></li>
<li><p>To extract the hour, type <code>=HOUR(NOW()-TODAY())</code> and similarly for minute and second.</p></li>
</ol>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="preferred-date-format" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Preferred date format</h3>
<p>It is much safer to store dates with <a href="#day">YEAR, MONTH, DAY</a> in separate columns or as <a href="#doy">YEAR and DAY-OF-YEAR</a> in separate columns.</p>
<p><strong>Note</strong>: Excel is unable to parse dates from before 1899-12-31, and will thus leave these untouched. If you’re mixing historic data from before and after this date, Excel will translate only the post-1900 dates into its internal format, thus resulting in mixed data. If you’re working with historic data, be extremely careful with your dates!</p>
<p>Excel also entertains a second date system, the 1904 date system, as the default in Excel for Macintosh. This system will assign a different serial number than the <a href="https://support.microsoft.com/en-us/help/214330/differences-between-the-1900-and-the-1904-date-system-in-excel">1900 date system</a>. Because of this, <a href="http://uc3.cdlib.org/2014/04/09/abandon-all-hope-ye-who-enter-dates-in-excel/">dates must be checked for accuracy when exporting data from Excel</a> (look for dates that are ~4 years off).</p>
</div>
<div id="data-formats-in-spreadsheets" class="section level3">
<h3><span class="header-section-number">1.5.2</span> Data formats in spreadsheets</h3>
<p>Spreadsheet programs have numerous “useful features” which allow them to handle dates in a variety of ways.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<p class="caption marginnote shownote">
Figure 1.5: Many formats, many ambiguities
</p>
<img src="figs/5_excel_dates_1.jpg" alt="Many formats, many ambiguities" width="100%"  />
</div>
<p>But these “features” often allow ambiguity to creep into your data. Ideally, data should be as unambiguous as possible.</p>
</div>
<div id="dates-stored-as-integers" class="section level3">
<h3><span class="header-section-number">1.5.3</span> Dates stored as integers</h3>
<p>The first thing you need to know is that Excel stores dates as numbers - see the last column in the above figure. Essentially, it counts the days from a default of December 31, 1899, and thus stores July 2, 2014 as the serial number 41822<label for="tufte-sn-3" class="margin-toggle sidenote-number">3</label><input type="checkbox" id="tufte-sn-3" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">3</span> But wait. That’s the default on my version of Excel. We’ll get into how this can introduce problems down the line later in this lesson.</span>.</p>
<p>This serial number thing can actually be useful in some circumstances. By using the above functions we can easily add days, months or years to a given date. Say you had a sampling plan where you needed to sample every thirty seven days. In another cell, you could type:</p>
<pre><code>=B2+37</code></pre>
<p>And it would return</p>
<pre><code>8-Aug</code></pre>
<p>because it understands the date as a number <code>41822</code>, and <code>41822 + 37 = 41859</code> which Excel interprets as August 8, 2014. It retains the format (for the most part) of the cell that is being operated upon, (unless you did some sort of formatting to the cell before, and then all bets are off). Month and year rollovers are internally tracked and applied.</p>
<p><strong>Note</strong> Adding years and months and days is slightly trickier because we need to make sure that we are adding the amount to the correct entity.</p>
<ul>
<li>First we extract the single entities (day, month or year)</li>
<li>We can then add values to to that</li>
<li>Finally the complete date string is reconstructed using the <code>DATE()</code> function.</li>
</ul>
<p>As for dates, times are handled in a similar way; seconds can be directly added but to add hour and minutes we need to make sure that we are adding the quantities to the correct entities.</p>
<p>Which brings us to the many different ways Excel provides in how it displays dates. If you refer to the figure above, you’ll see that there are many ways that ambiguity creeps into your data depending on the format you chose when you enter your data, and if you’re not fully aware of which format you’re using, you can end up actually entering your data in a way that Excel will badly misinterpret.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>What happens to the dates in the ‘dates’ tab of our workbook if we save this sheet in Excel (in <code>csv</code> format) and then open the file in a plain text editor (like TextEdit or Notepad)? What happens to the dates if we then open the <code>csv</code> file in Excel?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-3" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-3&#39;, &#39;sol-start-3&#39;)"></span>
</p>
<div id="sol-body-3" class="solution-body" style="display: none;">
<ul>
<li><p>Click on the “dates” tab of the workbook and double-click on any of the values in the <code>Date collected</code> column. Notice that the dates display with the year 2015.</p></li>
<li><p>Select <code>File -&gt; Save As</code> in Excel and in the drop down menu for file format select <code>CSV UTF-8 (Comma delimited) (.csv)</code>. Click <code>Save</code>.</p></li>
<li><p>You will see a pop-up that says “This workbook cannot be saved in the selected file format because it contains multiple sheets.” Choose <code>Save Active Sheet</code>.</p></li>
<li><p>Navigate to the file in your finder application. Right click and select <code>Open With</code>. Choose a plain text editor such as Notepad and view the file. Notice that the dates display as month/day without any year information.</p></li>
<li><p>Now right click on the file again and open with Excel. Notice that the dates display with the current year, not 2015.</p></li>
</ul>
<p>As you can see, exporting data from Excel and then importing it back into Excel fundamentally changed the data!</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><strong>Note</strong> You will notice that when exporting into a text-based format (such as CSV), Excel will export its internal date integer instead of a useful value (that is, the dates will be represented as integer numbers). This can potentially lead to problems if you use other software to manipulate the file.</p>
</div>
<div id="advantages-of-alternative-date-formatting" class="section level3">
<h3><span class="header-section-number">1.5.4</span> Advantages of Alternative Date Formatting</h3>
<div id="storing-dates-as-year-month-day" class="section level4 unnumbered">
<h4>Storing dates as YEAR, MONTH, DAY</h4>
<p>Storing dates in YEAR, MONTH, DAY format helps remove this ambiguity. Let’s look at this issue a bit closer.</p>
<p>For instance this is a spreadsheet representing insect counts that were taken every few days over the summer, and things went something like this:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<p class="caption marginnote shownote">
Figure 1.6: So, so ambiguous, it’s even confusing Excel.
</p>
<img src="figs/6_excel_dates_2.jpg" alt="So, so ambiguous, it's even confusing Excel." width="70%"  />
</div>
<p>If Excel was to be believed, this person had been collecting bugs <strong>in the future</strong>. Now, we have no doubt this person is highly capable, but I believe time travel was beyond even their grasp.</p>
<p>Entering dates in one cell is helpful but due to the fact that the spreadsheet programs may interpret and save the data in different ways (doing that somewhat behind the scenes), there is a better practice.</p>
<p>In dealing with dates in spreadsheets, separate date data into separate fields (day, month, year), which will eliminate any chance of ambiguity.</p>
</div>
<div id="storing-dates-as-year-day-of-year" class="section level4 unnumbered">
<h4>Storing dates as YEAR, DAY-OF-YEAR</h4>
<p>There is also another option. You can also store dates as year and day of year (DOY). Why? Because depending on your question, this might be what’s useful to you, and there is practically no possibility for ambiguity creeping in.</p>
<p>Statistical models often incorporate year as a factor, or a categorical variable, rather than a numeric variable, to account for year-to-year variation, and DOY can be used to measure the passage of time within a year.</p>
<p>So, can you convert all your dates into DOY format? Well, in Excel, here’s a useful guide:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<p class="caption marginnote shownote">
Figure 1.7: Kill that ambiguity before it bites you!
</p>
<img src="figs/7_excel_dates_3.jpg" alt="Kill that ambiguity before it bites you!" width="70%"  />
</div>
</div>
<div id="storing-dates-as-a-single-string" class="section level4 unnumbered">
<h4>Storing dates as a single string</h4>
<p>Another alternative could be to convert the date string into a single string using the <code>YYYYMMDDhhmmss</code> format. For example the date <code>March 24, 2015 17:25:35</code> would become <code>20150324172535</code>, where:</p>
<pre><code>YYYY:   the full year, i.e. 2015
MM:     the month, i.e. 03
DD:     the day of month, i.e. 24
hh:     hour of day, i.e. 17
mm:     minutes, i.e. 25
ss:     seconds, i.e. 35</code></pre>
<p>Such strings will be correctly sorted in ascending or descending order, and by knowing the format they can then be correctly processed by the receiving software.</p>
</div>
</div>
</div>
<div id="data-integrity" class="section level2">
<h2><span class="header-section-number">1.6</span> Data integrity</h2>
<p>Questions:</p>
<ul>
<li>How can we carry out basic quality control and quality assurance in spreadsheets?</li>
</ul>
<p>Objectives:</p>
<ul>
<li>Apply quality control techniques to identify errors in spreadsheets and limit incorrect data entry.</li>
</ul>
<p>Keypoints:</p>
<ul>
<li>Always copy your original spreadsheet file and work with a copy so you don’t affect the raw data.</li>
<li>Use data validation to prevent accidentally entering invalid data.</li>
<li>Use sorting to check for invalid data.</li>
<li>Use conditional formatting (cautiously) to check for invalid data.</li>
</ul>
<p>When you have a well-structured data table, you can use several simple techniques within your spreadsheet to ensure the data you enter is free of errors. These approaches include techniques that are implemented prior to entering data (quality assurance) and techniques that are used after entering data to check for errors (quality control).</p>
<div id="quality-assurance" class="section level3">
<h3><span class="header-section-number">1.6.1</span> Quality Assurance</h3>
<p>Quality assurance stops bad data from ever being entered by checking to see if values are valid during data entry. For example, if research is being conducted at sites A, B, and C, then the value V (which is right next to B on the keyboard) should never be entered. Likewise if one of the kinds of data being collected is a count, only integers greater than or equal to zero should be allowed.</p>
<p>To control the kind of data entered into a a spreadsheet we use Data Validation (Excel) or Validity (Libre Office Calc), to set the values that can be entered in each data column.</p>
<ol style="list-style-type: decimal">
<li><p>Select the cells or column you want to validate</p></li>
<li><p>On the <code>Data</code> tab select <code>Data Validation</code></p></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-8"></span>
<p class="caption marginnote shownote">
Figure 1.8: Image of Data Validation button on Data tab.
</p>
<img src="figs/data_validation.png" alt="Image of Data Validation button on Data tab." width="50%"  />
</div>
<ol start="3" style="list-style-type: decimal">
<li>In the <code>Allow</code> box select the kind of data that should be in the column. Options include whole numbers, decimals, lists of items, dates, and other values.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<p class="caption marginnote shownote">
Figure 1.9: Image of Data Validation window.
</p>
<img src="figs/data_validation_window.png" alt="Image of Data Validation window." width="50%"  />
</div>
<ol start="4" style="list-style-type: decimal">
<li>After selecting an item enter any additional details. For example, if you’ve chosen a list of values, enter a comma-delimited list of allowable values in the <code>Source</code> box.</li>
</ol>
<p>Let’s try this out by setting the plot column in our spreadsheet to only allow plot values that are integers between 1 and 24.</p>
<ol style="list-style-type: decimal">
<li>Select the <code>plot_id</code> column</li>
<li>On the <code>Data</code> tab select <code>Data Validation</code></li>
<li>In the <code>Allow</code> box select <code>Whole number</code></li>
<li>Set the minimum and maximum values to 1 and 24.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-10"></span>
<p class="caption marginnote shownote">
Figure 1.10: Image of Data Validation window for validating plot values.
</p>
<img src="figs/plot_validation.png" alt="Image of Data Validation window for validating plot values." width="50%"  />
</div>
<p>Now let’s try entering a new value in the plot column that isn’t a valid plot. The spreadsheet stops us from entering the wrong value and asks us if we would like to try again.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-11"></span>
<p class="caption marginnote shownote">
Figure 1.11: Image of error when trying to enter invalid data.
</p>
<img src="figs/invalid_value.png" alt="Image of error when trying to enter invalid data." width="50%"  />
</div>
<p>You can also customize the resulting message to be more informative by entering your own message in the <code>Input Message</code> tab</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-12"></span>
<p class="caption marginnote shownote">
Figure 1.12: Image of Input Message tab.
</p>
<img src="figs/input_message.png" alt="Image of Input Message tab." width="50%"  />
</div>
<p>or allow invalid data to result in a warning rather than an error by modifying the <code>Style</code> option on the <code>Error Alert</code> tab.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<p class="caption marginnote shownote">
Figure 1.13: Image of Error Alert tab.
</p>
<img src="figs/error_alert.png" alt="Image of Error Alert tab." width="50%"  />
</div>
<p>Quality assurance can make data entry easier as well as more robust. For example, if you use a list of options to restrict data entry, the spreadsheet will provide you with a drop-downlist of the available items. So, instead of trying to remember how to spell <em>Dipodomys spectabilis</em>, you can select the right option from the list.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-14"></span>
<p class="caption marginnote shownote">
Figure 1.14: Image of drop-down menu.
</p>
<img src="figs/drop_down_list.png" alt="Image of drop-down menu." width="50%"  />
</div>
</div>
<div id="quality-control" class="section level3">
<h3><span class="header-section-number">1.6.2</span> Quality Control</h3>
<p>Tip: <em>Before doing any quality control operations, save your original file with the formulas and a name indicating it is the original data. Create a separate file with appropriate naming and versioning, and ensure your data is stored as values and not as formulas. Because formulas refer to other cells, and you may be moving cells around, you may compromise the integrity of your data if you do not take this step!</em></p>
<p>README files: As you start manipulating your data files, create a readMe document / text file to keep track of your files and document your manipulations so that they may be easily understood and replicated, either by your future self or by an independent researcher. Your readMe file should document all of the files in your data set (including documentation), describe their content and format, and lay out the organizing principles of folders and subfolders. For each of the separate files listed, it is a good idea to document the manipulations or analyses that were carried out on those data. <a href="https://data.research.cornell.edu/content/readme">Cornell University’s Research Data Management Service Group</a> provides detailed guidelines for how to write a good readMe file, along with an adaptable template.</p>
<div id="sorting" class="section level4 unnumbered">
<h4>Sorting</h4>
<p>Bad values often sort to the bottom or top of the column. For example, if your data should be numeric, then alphabetical and null data will group at the ends of the sorted data. Sort your data by each field, one at a time. Scan through each column, but pay the most attention to the top and the bottom of a column. If your dataset is well-structured and does not contain formulas, sorting should never affect the integrity of your dataset.</p>
<p><strong>Remember</strong> to expand your sort in order to prevent data corruption. Expanding your sort ensures that the all the data in one row move together instead of only sorting a single column in isolation. Sorting by only a single column will scramble your data - a single row will no longer represent an individual observation.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>We’ve combined all of the tables from the messy data into a single table in a single tab. Download this semi-cleaned data file to your computer: <a href="https://github.com/datacarpentry/spreadsheet-ecology-lesson/blob/gh-pages/data/survey_sorting_exercise.xlsx?raw=true">survey_sorting_exercise</a></p>
<p>Once downloaded, sort the <code>Weight_grams</code> column in your spreadsheet program from <code>Largest to Smallest</code>.</p>
<p>What do you notice?</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-4" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-4&#39;, &#39;sol-start-4&#39;)"></span>
</p>
<div id="sol-body-4" class="solution-body" style="display: none;">
<p>Click the Sort button on the data tab in Excel. A pop-up will appear. Make sure you select <code>Expand the selection</code>.</p>
<div class="figure">
<img src="figs/sorting_button.png" />

</div>
<p>The following window will display, choose the column you want to sort as well as the sort order.</p>
<div class="figure">
<img src="figs/sorting_example.png" />

</div>
<p><strong>Note</strong> how the odd values sort to the top and bottom of the tabular data. The cells containing no data values sort to the bottom of the tabular data, while the cells where the letter “g” was included can be found towards the top. This is a powerful way to check your data for outliers and odd values.</p>
<div class="figure">
<img src="figs/sorting_solution_1.png" />

</div>
<div class="figure">
<img src="figs/sorting_solution_2.png" />

</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="conditional-formatting" class="section level4 unnumbered">
<h4>Conditional formatting</h4>
<p>Conditional formatting basically can do something like color code your values by some criteria or lowest to highest. This makes it easy to scan your data for outliers.</p>
<p>Conditional formatting should be used with caution, but it can be a great way to flag inconsistent values when entering data.</p>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<ol style="list-style-type: decimal">
<li><p>In the main Excel menu bar, click <code>Format</code> &gt; <code>Conditional Formating...</code> Click the <code>+</code> to add a formatting rule.</p></li>
<li><p>Apply a <code>2-Color Scale</code> formatting rule with the lowest values set to orange and the highest values set to yellow.</p></li>
<li><p>Now we can scan through and different colors will stand out. Do you notice any strange values?</p></li>
</ol>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
► Solution<span id="sol-start-5" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility(&#39;sol-body-5&#39;, &#39;sol-start-5&#39;)"></span>
</p>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p>Cells that contain non-numerical values are not colored. This includes both the cells where the letter “g” was included and the empty cells.</p>
<div class="figure">
<img src="figs/conditional_formating.png" />

</div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>It is nice to do be able to do these scans in spreadsheets, but we also can do these checks in a programming language like R or SQL.</p>
</div>
</div>
</div>
<div id="exporting-data" class="section level2">
<h2><span class="header-section-number">1.7</span> Exporting data</h2>
<p>Questions:</p>
<ul>
<li>How can we export data from spreadsheets in a way that is useful for downstream applications?</li>
</ul>
<p>Objectives:</p>
<ul>
<li>Store spreadsheet data in universal file formats.</li>
<li>Export data from a spreadsheet to a CSV file.</li>
</ul>
<p>Keypoints:</p>
<ul>
<li><p>Data stored in common spreadsheet formats will often not be read correctly into data analysis software, introducing errors into your data.</p></li>
<li><p>Exporting data from spreadsheets to formats like CSV or TSV puts it in a format that can be used consistently by most programs.</p></li>
</ul>
<p>Storing the data you’re going to work with for your analyses in Excel default file format (<code>*.xls</code> or <code>*.xlsx</code> - depending on the Excel version) isn’t a good idea. Why?</p>
<ul>
<li><p>Because it is a proprietary format, and it is possible that in the future, technology won’t exist (or will become sufficiently rare) to make it inconvenient, if not impossible, to open the file.</p></li>
<li><p>Other spreadsheet software may not be able to open files saved in a proprietary Excel format.</p></li>
<li><p>Different versions of Excel may handle data differently, leading to inconsistencies.</p></li>
<li><p>Finally, more journals and grant agencies are requiring you to deposit your data in a data repository, and most of them don’t accept Excel format. It needs to be in one of the formats discussed below.</p></li>
<li><p>The above points also apply to other formats such as open data formats used by LibreOffice / Open Office. These formats are not static and do not get parsed the same way by different software packages.</p></li>
</ul>
<p>As an example of inconsistencies in data storage, do you remember how we talked about how Excel stores dates earlier? It turns out that there are multiple defaults for different versions of the software, and you can switch between them all. So, say you’re compiling Excel-stored data from multiple sources. There’s dates in each file- Excel interprets them as their own internally consistent serial numbers. When you combine the data, Excel will take the serial number from the place you’re importing it from, and interpret it using the rule set for the version of Excel you’re using. Essentially, you could be adding errors to your data, and it wouldn’t necessarily be flagged by any data cleaning methods if your ranges overlap.</p>
<p>Storing data in a universal, open, and static format will help deal with this problem. Try tab-delimited (tab separated values or TSV) or comma-delimited (comma separated values or CSV). CSV files are plain text files where the columns are separated by commas, hence ‘comma separated values’ or CSV. The advantage of a CSV file over an Excel/SPSS/etc. file is that we can open and read a CSV file using just about any software, including plain text editors like TextEdit or NotePad. Data in a CSV file can also be easily imported into other formats and environments, such as SQLite and R. We’re not tied to a certain version of a certain expensive program when we work with CSV files, so it’s a good format to work with for maximum portability and endurance. Most spreadsheet programs can save to delimited text formats like CSV easily, although they may give you a warning during the file export.</p>
<p>To save a file you have opened in Excel in CSV format:</p>
<ol style="list-style-type: decimal">
<li>From the top menu select ‘File’ and ‘Save as’.</li>
<li>In the ‘Format’ field, from the list, select ‘Comma Separated Values’ (<code>*.csv</code>).</li>
<li>Double check the file name and the location where you want to save it and hit ‘Save’.</li>
</ol>
<p>An important note for backwards compatibility: you can open CSV files in Excel!</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<p class="caption marginnote shownote">
Figure 1.15: Saving an Excel file to CSV.
</p>
<img src="figs/excel-to-csv.png" alt="Saving an Excel file to CSV." width="70%"  />
</div>
<div id="a-note-on-cross-platform-operability" class="section level4 unnumbered">
<h4>A Note on Cross-platform Operability</h4>
<p>By default, most coding and statistical environments expect UNIX-style line endings (<code>\n</code>) as representing line breaks. However, Windows uses an alternate line ending signifier (<code>\r\n</code>) by default for legacy compatibility with Teletype-based systems.</p>
<p>As such, when exporting to CSV using Excel, your data in text format will look like this:</p>
<pre><code>data1,data2\r\n1,2\r\n4,5\r\n</code></pre>
<p>When opening your CSV file in Excel again, it will parse it as follows:</p>
<p><img src="figs/db4a5786-1643-11e7-931a-ca2c72336878.png" width="40%"  style="display: block; margin: auto;" /></p>
<p>However, if you open your CSV file on a different system that does not parse the <code>\r</code> it will interpret your CSV file differently:</p>
<p>Your data in text format then look like this:</p>
<pre><code>data1
data2\r
1
2\r
...</code></pre>
<p>This will then in turn parse as:</p>
<p><img src="figs/a990327c-1645-11e7-90b5-35a44e90f8d9.png" width="40%"  style="display: block; margin: auto;" /></p>
<p>thus causing terrible things to happen to your data. For example, <code>2\r</code> is not a valid integer, and thus will throw an error (if you’re lucky) when you attempt to operate on it in R or Python. Note that this happens on Excel for OSX as well as Windows, due to legacy Windows compatibility.</p>
<p>There are a handful of solutions for enforcing uniform UNIX-style line endings on your exported CSV files:</p>
<ol style="list-style-type: decimal">
<li><p>When exporting from Excel, save as a “Windows comma separated (.csv)” file</p></li>
<li><p>If you store your data file under version control using Git, edit the <code>.git/config</code> file in your repository to automatically translate <code>\r\n</code> line endings into <code>\n</code>. Add the following to the file (<a href="http://nicercode.github.io/blog/2013-04-30-excel-and-line-endings">see the detailed tutorial</a>):</p>
<pre><code>        [filter &quot;cr&quot;]
        clean = LC_CTYPE=C awk &#39;{printf(\&quot;%s\\n\&quot;, $0)}&#39; | LC_CTYPE=C tr &#39;\\r&#39; &#39;\\n&#39;
        smudge = tr &#39;\\n&#39; &#39;\\r&#39;`</code></pre></li>
</ol>
<p>and then create a file <code>.gitattributes</code> that contains the line:</p>
<pre><code>            *.csv filter=cr</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Use <a href="http://dos2unix.sourceforge.net/">dos2unix</a> (available on OSX, *nix, and Cygwin) on local files to standardize line endings.</li>
</ol>
</div>
<div id="a-note-on-r-and-xls" class="section level4 unnumbered">
<h4>A note on R and <code>xls</code></h4>
<p>There are R packages that can read <code>xls</code> files (as well as Google spreadsheets). It is even possible to access different worksheets in the <code>xls</code> documents.</p>
<p><strong>But</strong></p>
<ul>
<li>some of these only work on Windows</li>
<li>this equates to replacing a (simple but manual) export to <code>csv</code> with additional complexity/dependencies in the data analysis R code</li>
<li>data formatting best practice still apply</li>
<li>Is there really a good reason why <code>csv</code> (or similar) is not adequate?</li>
</ul>
</div>
<div id="caveats-on-commas" class="section level4 unnumbered">
<h4>Caveats on commas</h4>
<p>In some datasets, the data values themselves may include commas (,). In that case, the software which you use (including Excel) will most likely incorrectly display the data in columns. This is because the commas which are a part of the data values will be interpreted as delimiters.</p>
<p>For example, our data might look like this:</p>
<pre><code>species_id,genus,species,taxa
AB,Amphispiza,bilineata,Bird
AH,Ammospermophilus,harrisi,Rodent, not censused
AS,Ammodramus,savannarum,Bird
BA,Baiomys,taylori,Rodent</code></pre>
<p>In the record <code>AH,Ammospermophilus,harrisi,Rodent, not censused</code> the value for <code>taxa</code> includes a comma (<code>Rodent, not censused</code>). If we try to read the above into Excel (or other spreadsheet program), we will get something like this:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-18"></span>
<p class="caption marginnote shownote">
Figure 1.16: The risks of having commas inside comma-separated data.
</p>
<img src="figs/csv-mistake.png" alt="The risks of having commas inside comma-separated data." width="80%"  />
</div>
<p>The value for <code>taxa</code> was split into two columns (instead of being put in one column <code>D</code>). This can propagate to a number of further errors. For example, the extra column will be interpreted as a column with many missing values (and without a proper header). In addition to that, the value in column <code>D</code> for the record in row 3 (so the one where the value for ‘taxa’ contained the comma) is now incorrect.</p>
<p>If you want to store your data in <code>csv</code> format and expect that your data values may contain commas, you can avoid the problem discussed above by putting the values in quotes (“”). Applying this rule, our data might look like this:</p>
<pre><code>species_id,genus,species,taxa
&quot;AB&quot;,&quot;Amphispiza&quot;,&quot;bilineata&quot;,&quot;Bird&quot;
&quot;AH&quot;,&quot;Ammospermophilus&quot;,&quot;harrisi&quot;,&quot;Rodent, not censused&quot;
&quot;AS&quot;,&quot;Ammodramus&quot;,&quot;savannarum&quot;,&quot;Bird&quot;
&quot;BA&quot;,&quot;Baiomys&quot;,&quot;taylori&quot;,&quot;Rodent&quot;</code></pre>
<p>Now opening this file as a <code>csv</code> in Excel will not lead to an extra column, because Excel will only use commas that fall outside of quotation marks as delimiting characters.</p>
<p>Alternatively, if you are working with data that contains commas, you likely will need to use another delimiter when working in a spreadsheet<label for="tufte-sn-4" class="margin-toggle sidenote-number">4</label><input type="checkbox" id="tufte-sn-4" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">4</span> This is of course particularly relevant in European countries where the comma is used as a decimal separator. In such cases, the default value separator in a csv file will be the semi-colon (;), or values will be systematically quoted.</span>. In this case, consider using tabs as your delimiter and working with TSV files. TSV files can be exported from spreadsheet programs in the same way as CSV files.</p>
<p>If you are working with an already existing dataset in which the data values are not included in “” but which have commas as both delimiters and parts of data values, you are potentially facing a major problem with data cleaning. If the dataset you’re dealing with contains hundreds or thousands of records, cleaning them up manually (by either removing commas from the data values or putting the values into quotes - “”) is not only going to take hours and hours but may potentially end up with you accidentally introducing many errors.</p>
<p>Cleaning up datasets is one of the major problems in many scientific disciplines. The approach almost always depends on the particular context. However, it is a good practice to clean the data in an automated fashion, for example by writing and running a script. The Python and R lessons will give you the basis for developing skills to build relevant scripts.</p>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">1.8</span> Summary</h2>
<p>
<span class="marginnote shownote"> <!--
<div class="figure">--> <img src="figs/analysis.png" alt="A typical data analysis workflow."  /> <!--<span id="fig:analysis"></span>
<p class="caption marginnote">-->Figure 1.17: A typical data analysis workflow.<!--</p>--> <!--</div>--></span>
</p>
<p>A typical data analysis worflow is illustrated in figure <a href="sec-dataorg.html#fig:analysis">1.17</a>, where data is repeatedly tranformed, visualised, modelled. This iteration is repeated multiple times until the data is understood. In many real-life cases, however, most time is spend in clearning up and preparing the data, rather than actually analysing and understanding it.</p>
<p>An agile data analysis workflow, with several fast iteration of the transform/visualise/model cycle are only feasible is the data is formatted in a predictable way and one can reason on the data without having to look at it and/or fix it.</p>
</div>
<div id="additional-exercises" class="section level2">
<h2><span class="header-section-number">1.9</span> Additional exercises</h2>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Download the supplementary <a href="https://static-content.springer.com/esm/art%3A10.1038%2Fs41467-018-08191-w/MediaObjects/41467_2018_8191_MOESM4_ESM.xlsx">table</a> from <a href="https://www.nature.com/articles/s41467-018-08191-w">Geladaki et al. (2019)</a> that we discussed above.</p>
<p>Using the best practice documented above, export the file to a text-based spreadsheet (<code>csv</code>, <code>tsv</code>, …). If necessary, manually fix the table, but making sure you keep a copy of the original data and document your modifications.</p>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<ul>
<li><p>Download the <em>‘Luminescence read-out of a 96 well plate’</em> table presented as example above and reformat it in a way that makes it amenable to data analysis. Hint: The letters A to H and the numbers 1 to 12 represent respectively the rows and the columns of the plate.</p></li>
<li><p>The quantitative values in that data were formatted conditionally, using a colour scale to highlight different colour intensities. We have seen that this can be a useful feature for quality control. Can you interpret the colour pattern and make conclusion with respect to possibly quality implications.</p></li>
</ul>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="question">
<p class="question-begin">
► Question
</p>
<div class="question-body">
<p>Imagine the following experiment, and produce a data table, making up values for a dozen of observations.</p>
<blockquote>
<p>Rodents, either mice or rats, where collected on various days by either operator A or B. Their weight and tail length was measured and were then assigned to either a control group (and administered water) or a condition group (and administered drug X). Exactly one week later, the measurements on the animal were repeated.</p>
</blockquote>
<p class="question-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>

</div>
</div>
<p style="text-align: center;">
<a href="index.html"><button class="btn btn-default">Previous</button></a>
<a href="sec-startr.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2019-03-12
</p>
</div>
</div>



</body>
</html>
